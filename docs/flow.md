# UI DEV FLOW

### Создание нового компонента

Лично я топлю за [TDD](https://habr.com/ru/companies/ruvds/articles/450316/), поэтому большой акцент будет на тестирование =)

1. Создаем следующую структуру для компонента:
   ```
    component.stories.tsx
    component.module.scss
    component.test.tsx
    component.tsx
    index.ts
   ```
2. Создаем jest тесты для компонента
3. Создаем компонент
4. Правим тесты
5. Добавляем storybook play functions
6. Тестируем компонент (storybook + playroom + jest + create-react-app + Тестировщик)
7. Копируем компнент в нужный проект (до тех пор, пока все компоненты проекта не будут в UI)

### Добавление существующего компонента

1. Копируем компонент
2. Пишем тесты jest `component.test.tsx`
3. Создаем `component.stories.tsx` файл и добавляем истории
4. Добавляем play funcions
5. Тестируем компонент (storybook + playroom + jest + create-react-app + Тестировщик)

### Изменение компонента

1. Пишем тесты для изменений
2. Добавляем изменения
3. Тестируем компонент (storybook + playroom + jest + create-react-app + Тестировщик)
4. Публикация
5. Копируем компнент в нужный проект (до тех пор, пока все компоненты проекта не будут в UI)

## FAQ

- Зачем копировать компонент ?

  Так как в библиотеке сейчас не все компоненты, то обновление ее на проекте сломает его - поэтому, до тех пор пока на UI не будут все компоненты с проекта нужно его копировать

- Зачем play functions если есть jest?

  Для визуального прогона тестов (мб полезно для тестеров)

- Почему так много этапов тестирования (storybook + playroom + jest + create-react-app + Тестировщик)?

  - В storybook мы ведем непосредственно разработку
  - Playroom "используют" сеошники и нужно проверить что компонент доступен и ничего не упало
  - Тесты jest нужны для регрессионного тестирования и лучшего понимания задачи
  - Create-react-app нужен для проверки компонента после публикации
  - Тестировщик смотрит storybook и playroom + проект на который копируете

- Как происходит публикация ?
  1. При push в ветку (beta) срабатывает pipeline `publish`
  2. Pipeline запускает скрипт `publish:ui`
  3. На основе комитов semantic-release формирует версию библиотеки
  4. Сборка
  5. Публикация в nexus
